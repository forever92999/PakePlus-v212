<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›´æ’­å›¢é˜Ÿæœˆåº¦è€ƒæ ¸ç³»ç»Ÿ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“Š</text></svg>">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --warning: #f72585;
            --danger: #e63946;
            --dark: #1d3557;
            --light: #f8f9fa;
            --gray: #6c757d;
            --border: #dee2e6;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 8px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 0 20px;
            overflow-x: auto;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: var(--gray);
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tab:hover {
            color: var(--primary);
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: var(--dark);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--primary);
        }
        
        .card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        th, td {
            border: 1px solid var(--border);
            padding: 10px 12px;
            text-align: center;
        }
        
        th {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e9ecef;
        }
        
        .score-cell {
            font-weight: 600;
        }
        
        .high-score {
            color: var(--success);
        }
        
        .medium-score {
            color: var(--warning);
        }
        
        .low-score {
            color: var(--danger);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        select, input, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 16px;
            transition: border 0.3s ease, box-shadow 0.3s ease;
        }
        
        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .input-with-select {
            display: flex;
        }
        
        .input-with-select select {
            flex: 0 0 120px;
            border-right: none;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
        
        .input-with-select input {
            flex: 1;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary {
            background: var(--gray);
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-success:hover {
            background: #3aa8d0;
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .btn-danger:hover {
            background: #d32f2f;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .employee-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .employee-card {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            border-radius: var(--radius);
            padding: 15px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .employee-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .employee-card.active {
            border-color: var(--primary);
            background: #f0f4ff;
        }
        
        .employee-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .employee-info {
            flex: 1;
        }
        
        .employee-name {
            font-weight: 600;
            color: var(--dark);
        }
        
        .employee-position {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .locked-badge {
            background: var(--danger);
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .locked-row {
            background-color: #ffeaea !important;
        }
        
        .lock-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 1.1rem;
            transition: color 0.3s ease;
        }
        
        .lock-btn:hover {
            color: var(--danger);
        }
        
        .lock-btn.locked {
            color: var(--danger);
        }
        
        .awards-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .award-card {
            background: linear-gradient(135deg, #fff9e6 0%, #ffeacc 100%);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            border-left: 5px solid #ffc107;
        }
        
        .award-card.penalty {
            background: linear-gradient(135deg, #ffe6e6 0%, #ffcccc 100%);
            border-left-color: var(--danger);
        }
        
        .award-icon {
            font-size: 2.5rem;
            color: #ffc107;
            margin-bottom: 15px;
        }
        
        .award-card.penalty .award-icon {
            color: var(--danger);
        }
        
        .award-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .award-description {
            margin-bottom: 15px;
            color: var(--gray);
        }
        
        .award-winner {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
            padding: 10px;
            background: white;
            border-radius: var(--radius);
            text-align: center;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            background: var(--light);
            color: var(--gray);
            border-top: 1px solid var(--border);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius);
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .modal-header {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--dark);
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .scrollable-table {
            overflow-x: auto;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
        }
        
        .scrollable-table table {
            margin-bottom: 0;
            min-width: 1000px;
        }
        
        .penalty-cell {
            background-color: #fff3f3;
            color: var(--danger);
            font-weight: 600;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 15px 20px;
            z-index: 1001;
            max-width: 400px;
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary);
        }
        
        .notification.success {
            border-left-color: var(--success);
        }
        
        .notification.error {
            border-left-color: var(--danger);
        }
        
        .notification.warning {
            border-left-color: var(--warning);
        }
        
        .notification-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 1.1rem;
            margin-left: 15px;
        }
        
        .hidden {
            display: none;
        }
        
        .employee-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .employee-item:last-child {
            border-bottom: none;
        }
        
        .input-small {
            width: 80px;
            text-align: center;
        }
        
        .input-medium {
            width: 100px;
            text-align: center;
        }
        
        .input-large {
            width: 120px;
            text-align: center;
        }
        
        .icon-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .icon-option:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
        }
        
        .icon-option.active {
            border-color: var(--primary);
            background-color: #f0f4ff;
        }
        
        .icon-preview {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .penalty-list {
            margin-top: 20px;
        }
        
        .penalty-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .penalty-item:last-child {
            border-bottom: none;
        }
        
        .penalty-amount {
            color: var(--danger);
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 12px 15px;
                border-bottom: 1px solid var(--border);
                border-left: 3px solid transparent;
            }
            
            .tab.active {
                border-bottom: 1px solid var(--border);
                border-left: 3px solid var(--primary);
            }
            
            .employee-selector {
                flex-direction: column;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .scrollable-table {
                font-size: 12px;
            }
            
            .scrollable-table th, 
            .scrollable-table td {
                padding: 8px 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> ç›´æ’­å›¢é˜Ÿæœˆåº¦è€ƒæ ¸ç³»ç»Ÿ</h1>
            <p>ç§‘å­¦è¯„ä¼°å›¢é˜Ÿè¡¨ç°ï¼Œæ¿€åŠ±ä¼˜ç§€å‘˜å·¥ï¼Œæå‡æ•´ä½“ä¸šç»©</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="criteria">
                <i class="fas fa-clipboard-list"></i> è€ƒæ ¸æ ‡å‡†
            </div>
            <div class="tab" data-tab="daily">
                <i class="fas fa-calendar-day"></i> æ¯æ—¥è€ƒæ ¸
            </div>
            <div class="tab" data-tab="summary">
                <i class="fas fa-chart-bar"></i> æœˆåº¦æ±‡æ€»
            </div>
            <div class="tab" data-tab="awards">
                <i class="fas fa-trophy"></i> å¥–æƒ©è§„åˆ™
            </div>
            <div class="tab" data-tab="admin">
                <i class="fas fa-cog"></i> åŠŸèƒ½ç¼–è¾‘
            </div>
        </div>

        <div class="tab-content active" id="criteria-tab">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-clipboard-check"></i> è€ƒæ ¸æ ‡å‡†</h2>
                
                <div class="card">
                    <div class="card-header">
                        <span>ç›´æ’­å²—è€ƒæ ¸æ ‡å‡†</span>
                    </div>
                    <div class="scrollable-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>è€ƒæ ¸é¡¹</th>
                                    <th>è¦æ±‚</th>
                                    <th>æƒé‡</th>
                                    <th>è¯„åˆ†æ ‡å‡†</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ç›´æ’­æ—¶é•¿è¾¾æ ‡ç‡</td>
                                    <td>å•æ—¥æœ‰æ•ˆç›´æ’­æ—¶é•¿â‰¥3hï¼Œæ— ç¼ºå¸­</td>
                                    <td>25%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>0-59åˆ†é’Ÿï¼š0åˆ†</li>
                                            <li>60-119åˆ†é’Ÿï¼š10åˆ†</li>
                                            <li>120-179åˆ†é’Ÿï¼š15åˆ†</li>
                                            <li>180åˆ†é’Ÿï¼š25åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>çŸ­è§†é¢‘é…åˆåº¦</td>
                                    <td>æ¯äººæ¯æ—¥å†…è‡³å°‘å‚ä¸1-2æ¡çŸ­è§†é¢‘æ‹æ‘„</td>
                                    <td>25%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>æ‹æ‘„1æ¡ï¼š25åˆ†</li>
                                            <li>æ‹æ‘„2æ¡ï¼šå¥–åŠ±5åˆ†ï¼Œå…±30åˆ†</li>
                                            <li>ä¸æ‹æ‘„ï¼š0åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>å­¦ä¹ èƒ½åŠ›</td>
                                    <td>æŒæ¡äº§å“çŸ¥è¯†ã€ç›´æ’­è¯æœ¯ã€æ— äººæœºè€ƒè¯•ç†è®º</td>
                                    <td>20%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>äº§å“çŸ¥è¯†ï¼š0-5åˆ†</li>
                                            <li>ç›´æ’­è¯æœ¯ï¼š0-10åˆ†</li>
                                            <li>æ— äººæœºè€ƒè¯•ç†è®ºï¼š0-5åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>å·¥ä½œæ€åº¦</td>
                                    <td>è€ƒå‹¤åˆè§„æ€§ã€é…åˆåº¦</td>
                                    <td>30%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>è€ƒå‹¤åˆè§„æ€§ï¼š0-10åˆ†</li>
                                            <li>é…åˆåº¦ï¼š0-20åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <span>çŸ­è§†é¢‘å²—è€ƒæ ¸æ ‡å‡†</span>
                    </div>
                    <div class="scrollable-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>è€ƒæ ¸é¡¹</th>
                                    <th>è¦æ±‚</th>
                                    <th>æƒé‡</th>
                                    <th>è¯„åˆ†æ ‡å‡†</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>çŸ­è§†é¢‘å‘å¸ƒæƒ…å†µ</td>
                                    <td>æŒ‰æ—¶å‘å¸ƒé«˜è´¨é‡çŸ­è§†é¢‘</td>
                                    <td>20%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>æœªæŒ‰æ—¶å‘å¸ƒï¼š0åˆ†</li>
                                            <li>æŒ‰æ—¶å‘å¸ƒï¼š15åˆ†</li>
                                            <li>æå‰å‘å¸ƒï¼š20åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>çŸ­è§†é¢‘è´¨é‡</td>
                                    <td>ç”»é¢æ¸…æ™°ã€å†…å®¹åˆè§„ã€å­—å¹•å‡†ç¡®</td>
                                    <td>20%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>ä¸è¾¾æ ‡ï¼š0åˆ†</li>
                                            <li>è¾¾æ ‡ï¼š15åˆ†</li>
                                            <li>ä¼˜ç§€ï¼š20åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>æ‹æ‘„å‰ªè¾‘èƒ½åŠ›</td>
                                    <td>æ‹æ‘„æŠ€å·§ã€å‰ªè¾‘èƒ½åŠ›</td>
                                    <td>30%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>æ‹æ‘„æŠ€å·§ï¼š0-15åˆ†</li>
                                            <li>å‰ªè¾‘èƒ½åŠ›ï¼š0-15åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                                <tr>
                                    <td>å·¥ä½œæ€åº¦</td>
                                    <td>è€ƒå‹¤åˆè§„æ€§ã€é…åˆåº¦</td>
                                    <td>30%</td>
                                    <td>
                                        <ul style="text-align: left; margin: 0; padding-left: 20px;">
                                            <li>è€ƒå‹¤åˆè§„æ€§ï¼š0-10åˆ†</li>
                                            <li>é…åˆåº¦ï¼š0-20åˆ†</li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <span>è€ƒæ ¸è§„åˆ™è¯´æ˜</span>
                    </div>
                    <div class="card-body">
                        <ol>
                            <li><strong>è€ƒæ ¸ä¸è¾¾æ ‡å®šä¹‰</strong>ï¼šæœˆåº¦è€ƒæ ¸å¾—åˆ†ï¼œ80åˆ†ï¼ˆå«80åˆ†ï¼‰è§†ä¸ºæœˆåº¦è€ƒæ ¸ä¸è¾¾æ ‡</li>
                            <li><strong>å¾…æ”¹è¿›è®¡åˆ’</strong>ï¼šè¿ç»­2ä¸ªæœˆè€ƒæ ¸ä¸è¾¾æ ‡ï¼Œæˆ–å•æœˆè€ƒæ ¸å¾—åˆ†ï¼œ70åˆ†ï¼ˆå«70åˆ†ï¼‰çš„å‘˜å·¥ï¼Œéƒ¨é—¨ä¸»ç®¡åœ¨è€ƒæ ¸ç»“æœå…¬ç¤ºå3ä¸ªå·¥ä½œæ—¥å†…ï¼Œå‘å‘˜å·¥å‘æ”¾ã€Šå¾…æ”¹è¿›è®¡åˆ’é€šçŸ¥ä¹¦ã€‹ï¼Œæ˜ç¡®æ”¹è¿›ç›®æ ‡ã€æ”¹è¿›æªæ–½</li>
                            <li><strong>æ”¹è¿›å‘¨æœŸ</strong>ï¼šæ”¹è¿›å‘¨æœŸå†…ï¼Œéƒ¨é—¨è´Ÿè´£äººéœ€æ¯å‘¨ä¸å‘˜å·¥æ²Ÿé€šè¿›åº¦ï¼Œæä¾›å¿…è¦çš„æ”¯æŒä¸æŒ‡å¯¼</li>
                            <li><strong>æ”¹è¿›è€ƒæ ¸</strong>ï¼šæ”¹è¿›å‘¨æœŸç»“æŸåï¼ŒæŒ‰æœ¬æ–¹æ¡ˆè¿›è¡Œä¸“é¡¹è€ƒæ ¸ï¼Œä¸“é¡¹è€ƒæ ¸å¾—åˆ†â‰¥80åˆ†è§†ä¸ºæ”¹è¿›è¾¾æ ‡ï¼Œæ¢å¤æ­£å¸¸è€ƒæ ¸èŠ‚å¥ï¼›ä¸“é¡¹è€ƒæ ¸å¾—åˆ†ï¼œ80åˆ†è§†ä¸ºæ”¹è¿›æœªè¾¾æ ‡ï¼Œå…¬å¸æœ‰æƒè§£é™¤åè®®</li>
                            <li><strong>ä¼‘æ¯æ—¥å®‰æ’</strong>ï¼šæ¯æœˆå®‰æ’4å¤©ä¼‘æ¯æ—¥ï¼Œä¼‘æ¯æ—¥ä¸è®¡å…¥è€ƒæ ¸</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="daily-tab">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-calendar-alt"></i> æ¯æ—¥è€ƒæ ¸è®°å½•</h2>
                
                <div class="card">
                    <div class="card-header">
                        <span>é€‰æ‹©å‘˜å·¥ä¸æ—¥æœŸ</span>
                    </div>
                    <div class="employee-selector" id="employeeSelector">
                        <!-- å‘˜å·¥é€‰æ‹©å¡ç‰‡å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                    
                    <div class="form-group">
                        <label for="monthSelect">é€‰æ‹©è€ƒæ ¸æœˆä»½ï¼š</label>
                        <div class="input-with-select">
                            <select id="yearSelect">
                                <!-- å¹´ä»½é€‰é¡¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                            </select>
                            <select id="monthSelect">
                                <option value="1">1æœˆ</option>
                                <option value="2">2æœˆ</option>
                                <option value="3">3æœˆ</option>
                                <option value="4">4æœˆ</option>
                                <option value="5">5æœˆ</option>
                                <option value="6">6æœˆ</option>
                                <option value="7">7æœˆ</option>
                                <option value="8">8æœˆ</option>
                                <option value="9">9æœˆ</option>
                                <option value="10">10æœˆ</option>
                                <option value="11">11æœˆ</option>
                                <option value="12">12æœˆ</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div id="dailyTableContainer">
                    <!-- æ¯æ—¥è€ƒæ ¸è¡¨å°†æ ¹æ®é€‰æ‹©çš„å‘˜å·¥å²—ä½åŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-success" id="calculateBtn">
                        <i class="fas fa-calculator"></i> è®¡ç®—è€ƒæ ¸ç»“æœ
                    </button>
                    <button class="btn" id="saveDataBtn">
                        <i class="fas fa-save"></i> ä¿å­˜æ•°æ®
                    </button>
                </div>
            </div>
        </div>

        <div class="tab-content" id="summary-tab">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-chart-pie"></i> æœˆåº¦è€ƒæ ¸æ±‡æ€»</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalEmployees">0</div>
                        <div class="stat-label">æ€»å‘˜å·¥æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgScore">0.00</div>
                        <div class="stat-label">å¹³å‡å¾—åˆ†</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="qualifiedRate">0%</div>
                        <div class="stat-label">è¾¾æ ‡ç‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="excellentRate">0%</div>
                        <div class="stat-label">ä¼˜ç§€ç‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalPenalty">0</div>
                        <div class="stat-label">æ€»ç½šæ¬¾(å…ƒ)</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <span>æœˆåº¦è€ƒæ ¸æ±‡æ€»è¡¨</span>
                    </div>
                    <div class="scrollable-table">
                        <table id="summaryTable">
                            <thead>
                                <tr>
                                    <th width="10%">å‘˜å·¥å§“å</th>
                                    <th width="8%">å²—ä½</th>
                                    <th width="10%">ç›´æ’­æ—¶é•¿è¾¾æ ‡ç‡</th>
                                    <th width="10%">çŸ­è§†é¢‘é…åˆåº¦</th>
                                    <th colspan="3" style="background: var(--primary-light);">å­¦ä¹ èƒ½åŠ›åˆ†é¡¹</th>
                                    <th colspan="2" style="background: var(--primary-light);">å·¥ä½œæ€åº¦åˆ†é¡¹</th>
                                    <th width="8%">æœˆåº¦æ€»åˆ†</th>
                                    <th width="8%">æœˆåº¦ç½šæ¬¾</th>
                                    <th width="8%">è€ƒæ ¸ç­‰çº§</th>
                                </tr>
                                <tr>
                                    <th></th>
                                    <th></th>
                                    <th>å¹³å‡åˆ†/æ»¡åˆ†25</th>
                                    <th>å¹³å‡åˆ†/æ»¡åˆ†30</th>
                                    <th width="6%">äº§å“çŸ¥è¯†<br>å¹³å‡åˆ†/æ»¡åˆ†5</th>
                                    <th width="6%">ç›´æ’­è¯æœ¯<br>å¹³å‡åˆ†/æ»¡åˆ†10</th>
                                    <th width="6%">æ— äººæœºç†è®º<br>å¹³å‡åˆ†/æ»¡åˆ†5</th>
                                    <th width="6%">è€ƒå‹¤åˆè§„æ€§<br>å¹³å‡åˆ†/æ»¡åˆ†10</th>
                                    <th width="6%">é…åˆåº¦<br>å¹³å‡åˆ†/æ»¡åˆ†20</th>
                                    <th>å¹³å‡åˆ†/æ»¡åˆ†100</th>
                                    <th>æ€»é‡‘é¢(å…ƒ)</th>
                                    <th>ç­‰çº§</th>
                                </tr>
                            </thead>
                            <tbody id="summaryBody">
                                <!-- æ±‡æ€»å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="btn" id="downloadPdfBtn">
                        <i class="fas fa-file-pdf"></i> ç”ŸæˆPDFæŠ¥å‘Š
                    </button>
                    <button class="btn btn-secondary" id="exportDataBtn">
                        <i class="fas fa-file-export"></i> å¯¼å‡ºæ•°æ®
                    </button>
                </div>
            </div>
        </div>

        <div class="tab-content" id="awards-tab">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-award"></i> å¥–æƒ©è§„åˆ™</h2>
                
                <div class="awards-section">
                    <div class="award-card">
                        <div class="award-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="award-title">æœˆåº¦ä¸šç»©ä¹‹æ˜Ÿ</div>
                        <div class="award-description">
                            å„å²—ä½åˆ†åˆ«è¯„é€‰1åï¼Œè¦æ±‚æœˆåº¦è€ƒæ ¸å¾—åˆ†â‰¥90åˆ†ã€ä¸šç»©æŒ‡æ ‡å®Œæˆç‡æ’åç¬¬ä¸€ï¼Œä¸”æ— å¤„ç½šè®°å½•
                        </div>
                        <div class="award-reward">
                            <strong>å¥–åŠ±ï¼šç°é‡‘500å…ƒ</strong>
                        </div>
                        <div class="award-winner" id="performanceStarWinner">
                            æœ¬æœˆè·å¥–è€…ï¼š-
                        </div>
                    </div>
                    
                    <div class="award-card">
                        <div class="award-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="award-title">æœˆåº¦è¿›æ­¥ä¹‹æ˜Ÿ</div>
                        <div class="award-description">
                            è¯„é€‰1åï¼Œè¦æ±‚æœˆåº¦è€ƒæ ¸å¾—åˆ†è¾ƒä¸Šæœˆæå‡â‰¥10åˆ†ã€å¾—åˆ†â‰¥80åˆ†ï¼Œä¸”æ— æ–°å¢å¤„ç½šè®°å½•
                        </div>
                        <div class="award-reward">
                            <strong>å¥–åŠ±ï¼šç°é‡‘200å…ƒ</strong>
                        </div>
                        <div class="award-winner" id="progressStarWinner">
                            æœ¬æœˆè·å¥–è€…ï¼š-
                        </div>
                    </div>
                    
                    <div class="award-card penalty">
                        <div class="award-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="award-title">ç›´æ’­å²—å¤„ç½šæ ‡å‡†</div>
                        <div class="award-description">
                            <ul>
                                <li><strong>ç›´æ’­æ—¶é•¿å¤„ç½š</strong>ï¼šå•æ—¥æœ‰æ•ˆç›´æ’­æ—¶é•¿ä¸è¶³3å°æ—¶ï¼ŒæŒ‰å·®é¢åˆ†é’Ÿæ•°Ã—10å…ƒ/åˆ†é’Ÿæ‰£é™¤</li>
                                <li><strong>çŸ­è§†é¢‘æ‹æ‘„å¤„ç½š</strong>ï¼šæœªæŒ‰è¦æ±‚å®Œæˆåˆ†é…ä»»åŠ¡å†…çš„çŸ­è§†é¢‘æ‹æ‘„ï¼Œæ¯æ¡æ‰£50å…ƒ</li>
                                <li><strong>å®¢èµ„ä¿¡æ¯ç™»è®°å¤„ç½š</strong>ï¼šæœªæŒ‰è¦æ±‚ç™»è®°å®¢èµ„ä¿¡æ¯ï¼Œæ¯æ¬¡è¿è§„æ‰£é™¤20å…ƒ</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="award-card penalty">
                        <div class="award-icon">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                        <div class="award-title">çŸ­è§†é¢‘å²—å¤„ç½šæ ‡å‡†</div>
                        <div class="award-description">
                            <ul>
                                <li><strong>æœªæŒ‰æ—¶å‘å¸ƒè§†é¢‘</strong>ï¼šæœªåœ¨è§„å®šå‘å¸ƒæ—¶é—´å®Œæˆè§†é¢‘å‘å¸ƒï¼Œæ¯æ¡æ‰£50å…ƒ</li>
                                <li><strong>è§†é¢‘è´¨é‡ä¸è¾¾æ ‡</strong>ï¼šè§†é¢‘å­˜åœ¨ç”»é¢æ¨¡ç³Šã€å†…å®¹è¿è§„ç­‰é—®é¢˜ï¼Œæ¯æ¡æ‰£30å…ƒ</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <span>æœ¬æœˆå®é™…æƒ©ç½šè®°å½•</span>
                    </div>
                    <div class="penalty-list" id="penaltyList">
                        <!-- æƒ©ç½šè®°å½•å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-success" id="calculateAwardsBtn">
                        <i class="fas fa-trophy"></i> è®¡ç®—è¯„ä¼˜ç»“æœ
                    </button>
                </div>
            </div>
        </div>

        <div class="tab-content" id="admin-tab">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-user-cog"></i> åŠŸèƒ½ç¼–è¾‘</h2>
                
                <div class="card" id="adminLoginCard">
                    <div class="card-header">
                        <span>ç®¡ç†å‘˜éªŒè¯</span>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼š</label>
                        <input type="password" id="adminPassword" placeholder="è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
                    </div>
                    <div class="btn-group">
                        <button class="btn" id="verifyAdminBtn">
                            <i class="fas fa-key"></i> éªŒè¯èº«ä»½
                        </button>
                    </div>
                </div>
                
                <div id="adminFunctions" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <span>å‘˜å·¥ç®¡ç†</span>
                            <button class="btn btn-secondary" id="logoutAdminBtn">
                                <i class="fas fa-sign-out-alt"></i> é€€å‡ºç®¡ç†
                            </button>
                        </div>
                        <div class="form-group">
                            <label for="employeeName">å‘˜å·¥å§“åï¼š</label>
                            <input type="text" id="employeeName" placeholder="è¾“å…¥å‘˜å·¥å§“å">
                        </div>
                        <div class="form-group">
                            <label for="employeePosition">å²—ä½ï¼š</label>
                            <select id="employeePosition">
                                <option value="live">ç›´æ’­å²—</option>
                                <option value="video">çŸ­è§†é¢‘å²—</option>
                            </select>
                        </div>
                        <div class="btn-group">
                            <button class="btn" id="addEmployee">
                                <i class="fas fa-user-plus"></i> æ·»åŠ å‘˜å·¥
                            </button>
                        </div>
                        
                        <div class="employee-list" id="adminEmployeeList" style="margin-top: 20px;">
                            <!-- å‘˜å·¥ç®¡ç†åˆ—è¡¨å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <span>å¯†ç ç®¡ç†</span>
                        </div>
                        <div class="form-group">
                            <label for="currentAdminPassword">å½“å‰ç®¡ç†å‘˜å¯†ç ï¼š</label>
                            <input type="password" id="currentAdminPassword" placeholder="è¾“å…¥å½“å‰ç®¡ç†å‘˜å¯†ç ">
                        </div>
                        <div class="form-group">
                            <label for="newAdminPassword">æ–°ç®¡ç†å‘˜å¯†ç ï¼š</label>
                            <input type="password" id="newAdminPassword" placeholder="è¾“å…¥æ–°ç®¡ç†å‘˜å¯†ç ">
                        </div>
                        <div class="form-group">
                            <label for="confirmAdminPassword">ç¡®è®¤æ–°ç®¡ç†å‘˜å¯†ç ï¼š</label>
                            <input type="password" id="confirmAdminPassword" placeholder="å†æ¬¡è¾“å…¥æ–°ç®¡ç†å‘˜å¯†ç ">
                        </div>
                        <div class="btn-group">
                            <button class="btn" id="changeAdminPasswordBtn">
                                <i class="fas fa-lock"></i> ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
                            </button>
                        </div>
                        
                        <div class="form-group" style="margin-top: 20px;">
                            <label for="currentLockPassword">å½“å‰é”å®šå¯†ç ï¼š</label>
                            <input type="password" id="currentLockPassword" placeholder="è¾“å…¥å½“å‰é”å®šå¯†ç ">
                        </div>
                        <div class="form-group">
                            <label for="newLockPassword">æ–°é”å®šå¯†ç ï¼š</label>
                            <input type="password" id="newLockPassword" placeholder="è¾“å…¥æ–°é”å®šå¯†ç ">
                        </div>
                        <div class="form-group">
                            <label for="confirmLockPassword">ç¡®è®¤æ–°é”å®šå¯†ç ï¼š</label>
                            <input type="password" id="confirmLockPassword" placeholder="å†æ¬¡è¾“å…¥æ–°é”å®šå¯†ç ">
                        </div>
                        <div class="btn-group">
                            <button class="btn" id="changeLockPasswordBtn">
                                <i class="fas fa-lock"></i> ä¿®æ”¹é”å®šå¯†ç 
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <span>ç•Œé¢å®šåˆ¶</span>
                        </div>
                        <div class="form-group">
                            <label>é€‰æ‹©æ¡Œé¢å›¾æ ‡ï¼š</label>
                            <div class="icon-grid" id="iconGrid">
                                <!-- å›¾æ ‡é€‰é¡¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                            </div>
                        </div>
                        <div class="btn-group">
                            <button class="btn" id="applyIconBtn">
                                <i class="fas fa-check"></i> åº”ç”¨å›¾æ ‡
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <span>æ•°æ®ç®¡ç†</span>
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-secondary" id="importDataBtn">
                                <i class="fas fa-file-import"></i> å¯¼å…¥æ•°æ®
                            </button>
                            <button class="btn btn-secondary" id="backupDataBtn">
                                <i class="fas fa-download"></i> å¤‡ä»½æ•°æ®
                            </button>
                            <button class="btn btn-secondary" id="restoreDataBtn">
                                <i class="fas fa-upload"></i> æ¢å¤æ•°æ®
                            </button>
                            <button class="btn btn-danger" id="resetDataBtn">
                                <i class="fas fa-trash"></i> é‡ç½®æ•°æ®
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Â© 2025 ç›´æ’­å›¢é˜Ÿè€ƒæ ¸ç³»ç»Ÿ | è®¾è®¡ï¼šè¿è¥éƒ¨åº·æ™¶</p>
        </div>
    </div>

    <!-- å¯†ç éªŒè¯æ¨¡æ€æ¡† -->
    <div class="modal" id="passwordModal">
        <div class="modal-content">
            <div class="modal-header">è§£é”è®°å½•</div>
            <p>è¯·è¾“å…¥å¯†ç è§£é”æ­¤è®°å½•ï¼š</p>
            <input type="password" id="passwordInput" placeholder="è¾“å…¥å¯†ç ">
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="cancelUnlock">å–æ¶ˆ</button>
                <button class="btn" id="confirmUnlock">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥æ¶ˆæ¯å®¹å™¨ -->
    <div id="notification" class="notification hidden">
        <div class="notification-content">
            <span id="notification-message"></span>
            <button id="notification-close" class="notification-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <script>
        // å¸¸é‡å®šä¹‰
        const CONSTANTS = {
            DEFAULT_PASSWORDS: {
                LOCK: "123456",
                ADMIN: "123456"
            },
            SCORE_THRESHOLDS: {
                EXCELLENT: 90,
                GOOD: 80,
                PASS: 70
            },
            POSITIONS: {
                LIVE: "live",
                VIDEO: "video"
            },
            ICONS: [
                { icon: "ğŸ“Š", name: "å›¾è¡¨" },
                { icon: "ğŸ¯", name: "ç›®æ ‡" },
                { icon: "ğŸ†", name: "å¥–æ¯" },
                { icon: "â­", name: "æ˜Ÿæ˜Ÿ" },
                { icon: "ğŸ“ˆ", name: "å¢é•¿" },
                { icon: "ğŸ’¼", name: "å·¥ä½œ" },
                { icon: "ğŸ‘¥", name: "å›¢é˜Ÿ" },
                { icon: "ğŸ“", name: "ç¬”è®°" }
            ]
        };

        // åº”ç”¨çŠ¶æ€ç®¡ç†
        const AppState = {
            employees: [
                { id: 1, name: "å¼ ä¸‰", position: "live", selected: true },
                { id: 2, name: "æå››", position: "live", selected: true },
                { id: 3, name: "ç‹äº”", position: "video", selected: true },
                { id: 4, name: "èµµå…­", position: "video", selected: true }
            ],
            dailyData: {},
            currentDaysInMonth: 31,
            LOCK_PASSWORD: CONSTANTS.DEFAULT_PASSWORDS.LOCK,
            ADMIN_PASSWORD: CONSTANTS.DEFAULT_PASSWORDS.ADMIN,
            currentEmployeeId: 1,
            isAdminAuthenticated: false,
            currentMonth: new Date().getMonth() + 1,
            currentYear: new Date().getFullYear(),
            selectedIcon: "ğŸ“Š",
            previousMonthData: {}
        };

        // å·¥å…·å‡½æ•°
        const Utils = {
            // æ˜¾ç¤ºé€šçŸ¥
            showNotification(message, type = 'info') {
                const notification = document.getElementById('notification');
                const messageEl = document.getElementById('notification-message');
                
                messageEl.textContent = message;
                notification.className = `notification ${type}`;
                notification.classList.remove('hidden');
                
                // è‡ªåŠ¨éšè—
                setTimeout(() => {
                    this.hideNotification();
                }, 3000);
            },
            
            // éšè—é€šçŸ¥
            hideNotification() {
                const notification = document.getElementById('notification');
                notification.classList.add('hidden');
            },
            
            // éªŒè¯æ•°å­—è¾“å…¥
            validateNumberInput(value, min, max) {
                const num = parseInt(value);
                if (isNaN(num)) return false;
                return num >= min && num <= max;
            },
            
            // æ·±æ‹·è´å¯¹è±¡
            deepClone(obj) {
                return JSON.parse(JSON.stringify(obj));
            },
            
            // æ ¼å¼åŒ–æ—¥æœŸ
            formatDate(date) {
                return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
            },
            
            // æ›´æ”¹ç½‘ç«™å›¾æ ‡
            changeFavicon(icon) {
                // åˆ›å»ºæ–°çš„linkå…ƒç´ 
                const link = document.createElement('link');
                link.rel = 'icon';
                link.href = `data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>${icon}</text></svg>`;
                
                // ç§»é™¤ç°æœ‰çš„å›¾æ ‡
                const existingLink = document.querySelector("link[rel*='icon']");
                if (existingLink) {
                    document.head.removeChild(existingLink);
                }
                
                // æ·»åŠ æ–°å›¾æ ‡
                document.head.appendChild(link);
            },
            
            // è·å–ä¸Šä¸ªæœˆçš„é”®å€¼
            getPreviousMonthKey(year, month) {
                let prevYear = parseInt(year);
                let prevMonth = parseInt(month) - 1;
                
                if (prevMonth === 0) {
                    prevMonth = 12;
                    prevYear--;
                }
                
                return `${prevYear}-${prevMonth}`;
            }
        };

        // æ•°æ®ç®¡ç†æ¨¡å—
        const DataManager = {
            // ä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
            saveData() {
                const data = {
                    employees: AppState.employees,
                    dailyData: AppState.dailyData,
                    LOCK_PASSWORD: AppState.LOCK_PASSWORD,
                    ADMIN_PASSWORD: AppState.ADMIN_PASSWORD,
                    selectedIcon: AppState.selectedIcon,
                    previousMonthData: AppState.previousMonthData
                };
                try {
                    localStorage.setItem('liveTeamAssessmentData', JSON.stringify(data));
                    Utils.showNotification('æ•°æ®ä¿å­˜æˆåŠŸï¼', 'success');
                    return true;
                } catch (error) {
                    console.error('ä¿å­˜æ•°æ®å¤±è´¥:', error);
                    Utils.showNotification('æ•°æ®ä¿å­˜å¤±è´¥ï¼', 'error');
                    return false;
                }
            },
            
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
            loadData() {
                try {
                    const savedData = localStorage.getItem('liveTeamAssessmentData');
                    if (savedData) {
                        const data = JSON.parse(savedData);
                        AppState.employees = data.employees || AppState.employees;
                        AppState.dailyData = data.dailyData || AppState.dailyData;
                        AppState.LOCK_PASSWORD = data.LOCK_PASSWORD || AppState.LOCK_PASSWORD;
                        AppState.ADMIN_PASSWORD = data.ADMIN_PASSWORD || AppState.ADMIN_PASSWORD;
                        AppState.selectedIcon = data.selectedIcon || AppState.selectedIcon;
                        AppState.previousMonthData = data.previousMonthData || AppState.previousMonthData;
                        
                        // åº”ç”¨ä¿å­˜çš„å›¾æ ‡
                        Utils.changeFavicon(AppState.selectedIcon);
                        
                        Utils.showNotification('æ•°æ®åŠ è½½æˆåŠŸï¼', 'success');
                        return true;
                    }
                } catch (error) {
                    console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                    Utils.showNotification('æ•°æ®åŠ è½½å¤±è´¥ï¼', 'error');
                }
                return false;
            },
            
            // å¯¼å‡ºæ•°æ®
            exportData() {
                const data = {
                    employees: AppState.employees,
                    dailyData: AppState.dailyData,
                    exportDate: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `è€ƒæ ¸æ•°æ®_${Utils.formatDate(new Date())}.json`;
                link.click();
                
                Utils.showNotification('æ•°æ®å¯¼å‡ºæˆåŠŸï¼', 'success');
            },
            
            // å¯¼å…¥æ•°æ®
            importData(file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        AppState.employees = data.employees || AppState.employees;
                        AppState.dailyData = data.dailyData || AppState.dailyData;
                        
                        // é‡æ–°åˆå§‹åŒ–UI
                        UI.initEmployeeSelector();
                        UI.updateSummaryTable();
                        DataManager.saveData();
                        
                        Utils.showNotification('æ•°æ®å¯¼å…¥æˆåŠŸï¼', 'success');
                    } catch (error) {
                        console.error('å¯¼å…¥æ•°æ®å¤±è´¥:', error);
                        Utils.showNotification('æ•°æ®å¯¼å…¥å¤±è´¥ï¼Œæ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼', 'error');
                    }
                };
                reader.readAsText(file);
            },
            
            // é‡ç½®æ•°æ®
            resetData() {
                if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                    AppState.employees = [];
                    AppState.dailyData = {};
                    AppState.LOCK_PASSWORD = CONSTANTS.DEFAULT_PASSWORDS.LOCK;
                    AppState.ADMIN_PASSWORD = CONSTANTS.DEFAULT_PASSWORDS.ADMIN;
                    AppState.selectedIcon = "ğŸ“Š";
                    
                    localStorage.removeItem('liveTeamAssessmentData');
                    
                    // é‡æ–°åˆå§‹åŒ–UI
                    UI.initEmployeeSelector();
                    UI.updateSummaryTable();
                    
                    Utils.showNotification('æ•°æ®å·²é‡ç½®ï¼', 'success');
                }
            }
        };

        // UIç®¡ç†æ¨¡å—
        const UI = {
            // åˆå§‹åŒ–å‘˜å·¥é€‰æ‹©å™¨
            initEmployeeSelector() {
                const employeeSelector = document.getElementById('employeeSelector');
                employeeSelector.innerHTML = '';
                
                if (AppState.employees.length === 0) {
                    employeeSelector.innerHTML = '<p>æš‚æ— å‘˜å·¥æ•°æ®ï¼Œè¯·åœ¨åŠŸèƒ½ç¼–è¾‘ä¸­æ·»åŠ å‘˜å·¥ã€‚</p>';
                    return;
                }
                
                AppState.employees.forEach(employee => {
                    const card = document.createElement('div');
                    card.className = `employee-card ${employee.id === AppState.currentEmployeeId ? 'active' : ''}`;
                    card.innerHTML = `
                        <div class="employee-avatar">${employee.name.charAt(0)}</div>
                        <div class="employee-info">
                            <div class="employee-name">${employee.name}</div>
                            <div class="employee-position">${employee.position === 'live' ? 'ç›´æ’­å²—' : 'çŸ­è§†é¢‘å²—'}</div>
                        </div>
                    `;
                    card.addEventListener('click', () => {
                        AppState.currentEmployeeId = employee.id;
                        document.querySelectorAll('.employee-card').forEach(c => c.classList.remove('active'));
                        card.classList.add('active');
                        UI.initEmployeeDailyData(employee.id);
                    });
                    employeeSelector.appendChild(card);
                });
            },
            
            // åˆå§‹åŒ–å¹´ä»½é€‰æ‹©å™¨
            initYearSelector() {
                const yearSelect = document.getElementById('yearSelect');
                const currentYear = new Date().getFullYear();
                
                for (let i = currentYear - 5; i <= currentYear + 5; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i + 'å¹´';
                    if (i === currentYear) {
                        option.selected = true;
                    }
                    yearSelect.appendChild(option);
                }
            },
            
            // åˆå§‹åŒ–å‘˜å·¥æ¯æ—¥æ•°æ®
            initEmployeeDailyData(employeeId) {
                const employee = AppState.employees.find(emp => emp.id === employeeId);
                if (!employee) return;
                
                // è·å–å½“å‰é€‰æ‹©çš„æœˆä»½å’Œå¹´ä»½
                const month = document.getElementById('monthSelect').value;
                const year = document.getElementById('yearSelect').value;
                
                // è®¡ç®—å½“å‰æœˆä»½çš„å¤©æ•°
                AppState.currentDaysInMonth = new Date(year, month, 0).getDate();
                
                if (!AppState.dailyData[employeeId]) {
                    AppState.dailyData[employeeId] = {};
                }
                
                if (!AppState.dailyData[employeeId][`${year}-${month}`]) {
                    AppState.dailyData[employeeId][`${year}-${month}`] = [];
                }
                
                const employeeMonthData = AppState.dailyData[employeeId][`${year}-${month}`];
                
                // æ ¹æ®å²—ä½ç”Ÿæˆç›¸åº”çš„è¡¨æ ¼
                const tableContainer = document.getElementById('dailyTableContainer');
                tableContainer.innerHTML = '';
                
                if (employee.position === 'live') {
                    tableContainer.appendChild(this.createLiveTable(employee, employeeMonthData));
                } else {
                    tableContainer.appendChild(this.createVideoTable(employee, employeeMonthData));
                }
                
                // è®¡ç®—åˆå§‹å¾—åˆ†
                if (employee.position === 'live') {
                    Calculation.calculateLiveEmployeeScores(employeeId);
                } else {
                    Calculation.calculateVideoEmployeeScores(employeeId);
                }
            },
            
            // åˆ›å»ºç›´æ’­å²—è¡¨æ ¼
            createLiveTable(employee, employeeMonthData) {
                const card = document.createElement('div');
                card.className = 'card';
                
                const cardHeader = document.createElement('div');
                cardHeader.className = 'card-header';
                cardHeader.innerHTML = `<span>${employee.name} - ç›´æ’­å²—æ¯æ—¥è€ƒæ ¸è¡¨</span>`;
                card.appendChild(cardHeader);
                
                const scrollableTable = document.createElement('div');
                scrollableTable.className = 'scrollable-table';
                
                const table = document.createElement('table');
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th width="5%">æ—¥æœŸ</th>
                            <th width="8%">è€ƒå‹¤çŠ¶æ€</th>
                            <th width="10%">ç›´æ’­æ—¶é•¿(åˆ†é’Ÿ)</th>
                            <th width="10%">ç›´æ’­æ—¶é•¿å¾—åˆ†</th>
                            <th width="10%">çŸ­è§†é¢‘é…åˆ</th>
                            <th width="7%">äº§å“çŸ¥è¯†</th>
                            <th width="7%">ç›´æ’­è¯æœ¯</th>
                            <th width="7%">æ— äººæœºç†è®º</th>
                            <th width="8%">è€ƒå‹¤åˆè§„æ€§</th>
                            <th width="8%">é…åˆåº¦</th>
                            <th width="10%">å½“æ—¥å¾—åˆ†</th>
                            <th width="10%">å½“æ—¥ç½šæ¬¾</th>
                            <th width="5%">é”å®š</th>
                        </tr>
                    </thead>
                    <tbody id="liveDailyBody">
                        <!-- ç›´æ’­å²—æ¯æ—¥å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </tbody>
                `;
                
                const dailyBody = table.querySelector('#liveDailyBody');
                
                for (let i = 1; i <= AppState.currentDaysInMonth; i++) {
                    const row = document.createElement('tr');
                    const dayData = employeeMonthData[i-1] || {};
                    
                    // æ—¥æœŸ
                    const dateCell = document.createElement('td');
                    dateCell.textContent = i;
                    row.appendChild(dateCell);
                    
                    // è€ƒå‹¤çŠ¶æ€
                    const statusCell = document.createElement('td');
                    const statusSelect = document.createElement('select');
                    statusSelect.className = 'input-medium';
                    statusSelect.innerHTML = `
                        <option value="å·¥ä½œ">å·¥ä½œ</option>
                        <option value="ä¼‘æ¯">ä¼‘æ¯</option>
                    `;
                    statusSelect.value = dayData.status || (i % 7 === 0 || i % 8 === 0 ? 'ä¼‘æ¯' : 'å·¥ä½œ');
                    statusCell.appendChild(statusSelect);
                    row.appendChild(statusCell);
                    
                    // ç›´æ’­æ—¶é•¿(åˆ†é’Ÿ) - åˆ é™¤ä¸‹æ‹‰é€‰é¡¹ï¼Œåªä¿ç•™è¾“å…¥æ¡†
                    const liveDurationCell = document.createElement('td');
                    const liveDurationInput = document.createElement('input');
                    liveDurationInput.type = 'number';
                    liveDurationInput.min = '0';
                    liveDurationInput.max = '480';
                    liveDurationInput.value = dayData.liveDuration || '0';
                    liveDurationInput.className = 'input-medium live-duration-input';
                    liveDurationCell.appendChild(liveDurationInput);
                    row.appendChild(liveDurationCell);
                    
                    // ç›´æ’­æ—¶é•¿å¾—åˆ†
                    const liveScoreCell = document.createElement('td');
                    liveScoreCell.className = 'score-cell';
                    liveScoreCell.textContent = '0';
                    row.appendChild(liveScoreCell);
                    
                    // çŸ­è§†é¢‘é…åˆ
                    const videoCell = document.createElement('td');
                    const videoContainer = document.createElement('div');
                    videoContainer.className = 'input-with-select';
                    videoContainer.innerHTML = `
                        <select class="video-preset input-small">
                            <option value="0">ä¸æ‹æ‘„</option>
                            <option value="25">æ‹æ‘„1æ¡</option>
                            <option value="30">æ‹æ‘„2æ¡</option>
                        </select>
                        <input type="number" class="video-input input-small" min="0" max="30" value="${dayData.video || '0'}">
                    `;
                    videoCell.appendChild(videoContainer);
                    row.appendChild(videoCell);
                    
                    // äº§å“çŸ¥è¯†
                    const productCell = document.createElement('td');
                    const productInput = document.createElement('input');
                    productInput.type = 'number';
                    productInput.min = '0';
                    productInput.max = '5';
                    productInput.value = dayData.product || '0';
                    productInput.className = 'input-small product-input';
                    productCell.appendChild(productInput);
                    row.appendChild(productCell);
                    
                    // ç›´æ’­è¯æœ¯
                    const speechCell = document.createElement('td');
                    const speechInput = document.createElement('input');
                    speechInput.type = 'number';
                    speechInput.min = '0';
                    speechInput.max = '10';
                    speechInput.value = dayData.speech || '0';
                    speechInput.className = 'input-small speech-input';
                    speechCell.appendChild(speechInput);
                    row.appendChild(speechCell);
                    
                    // æ— äººæœºç†è®º
                    const droneCell = document.createElement('td');
                    const droneInput = document.createElement('input');
                    droneInput.type = 'number';
                    droneInput.min = '0';
                    droneInput.max = '5';
                    droneInput.value = dayData.drone || '0';
                    droneInput.className = 'input-small drone-input';
                    droneCell.appendChild(droneInput);
                    row.appendChild(droneCell);
                    
                    // è€ƒå‹¤åˆè§„æ€§
                    const attendanceCell = document.createElement('td');
                    const attendanceInput = document.createElement('input');
                    attendanceInput.type = 'number';
                    attendanceInput.min = '0';
                    attendanceInput.max = '10';
                    attendanceInput.value = dayData.attendance || '0';
                    attendanceInput.className = 'input-small attendance-input';
                    attendanceCell.appendChild(attendanceInput);
                    row.appendChild(attendanceCell);
                    
                    // é…åˆåº¦
                    const cooperationCell = document.createElement('td');
                    const cooperationInput = document.createElement('input');
                    cooperationInput.type = 'number';
                    cooperationInput.min = '0';
                    cooperationInput.max = '20';
                    cooperationInput.value = dayData.cooperation || '0';
                    cooperationInput.className = 'input-medium cooperation-input';
                    cooperationCell.appendChild(cooperationInput);
                    row.appendChild(cooperationCell);
                    
                    // å½“æ—¥å¾—åˆ†
                    const scoreCell = document.createElement('td');
                    scoreCell.className = 'score-cell';
                    scoreCell.textContent = '0';
                    row.appendChild(scoreCell);
                    
                    // å½“æ—¥ç½šæ¬¾
                    const penaltyCell = document.createElement('td');
                    penaltyCell.className = 'penalty-cell';
                    penaltyCell.textContent = '0';
                    row.appendChild(penaltyCell);
                    
                    // é”å®šæŒ‰é’®
                    const lockCell = document.createElement('td');
                    const lockBtn = document.createElement('button');
                    lockBtn.className = `lock-btn ${dayData.locked ? 'locked' : ''}`;
                    lockBtn.innerHTML = dayData.locked ? '<i class="fas fa-lock"></i>' : '<i class="fas fa-lock-open"></i>';
                    lockBtn.addEventListener('click', () => this.toggleLock(employee.id, i-1, lockBtn, row));
                    lockCell.appendChild(lockBtn);
                    row.appendChild(lockCell);
                    
                    if (dayData.locked) {
                        row.classList.add('locked-row');
                    }
                    
                    dailyBody.appendChild(row);
                    
                    // ä¿å­˜æ•°æ®å¼•ç”¨
                    employeeMonthData[i-1] = {
                        row,
                        statusSelect,
                        liveDurationInput,
                        liveScoreCell,
                        videoContainer,
                        productInput,
                        speechInput,
                        droneInput,
                        attendanceInput,
                        cooperationInput,
                        scoreCell,
                        penaltyCell,
                        lockBtn,
                        locked: dayData.locked || false
                    };
                    
                    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                    this.addEventListenersToLiveInputs(employeeMonthData[i-1]);
                }
                
                scrollableTable.appendChild(table);
                card.appendChild(scrollableTable);
                
                return card;
            },
            
            // åˆ›å»ºçŸ­è§†é¢‘å²—è¡¨æ ¼
            createVideoTable(employee, employeeMonthData) {
                const card = document.createElement('div');
                card.className = 'card';
                
                const cardHeader = document.createElement('div');
                cardHeader.className = 'card-header';
                cardHeader.innerHTML = `<span>${employee.name} - çŸ­è§†é¢‘å²—æ¯æ—¥è€ƒæ ¸è¡¨</span>`;
                card.appendChild(cardHeader);
                
                const scrollableTable = document.createElement('div');
                scrollableTable.className = 'scrollable-table';
                
                const table = document.createElement('table');
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th width="5%">æ—¥æœŸ</th>
                            <th width="8%">è€ƒå‹¤çŠ¶æ€</th>
                            <th width="12%">çŸ­è§†é¢‘å‘å¸ƒæƒ…å†µ</th>
                            <th width="12%">çŸ­è§†é¢‘è´¨é‡</th>
                            <th width="12%">æ‹æ‘„æŠ€å·§</th>
                            <th width="12%">å‰ªè¾‘èƒ½åŠ›</th>
                            <th width="8%">è€ƒå‹¤åˆè§„æ€§</th>
                            <th width="8%">é…åˆåº¦</th>
                            <th width="10%">å½“æ—¥å¾—åˆ†</th>
                            <th width="10%">å½“æ—¥ç½šæ¬¾</th>
                            <th width="5%">é”å®š</th>
                        </tr>
                    </thead>
                    <tbody id="videoDailyBody">
                        <!-- çŸ­è§†é¢‘å²—æ¯æ—¥å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </tbody>
                `;
                
                const dailyBody = table.querySelector('#videoDailyBody');
                
                for (let i = 1; i <= AppState.currentDaysInMonth; i++) {
                    const row = document.createElement('tr');
                    const dayData = employeeMonthData[i-1] || {};
                    
                    // æ—¥æœŸ
                    const dateCell = document.createElement('td');
                    dateCell.textContent = i;
                    row.appendChild(dateCell);
                    
                    // è€ƒå‹¤çŠ¶æ€
                    const statusCell = document.createElement('td');
                    const statusSelect = document.createElement('select');
                    statusSelect.className = 'input-medium';
                    statusSelect.innerHTML = `
                        <option value="å·¥ä½œ">å·¥ä½œ</option>
                        <option value="ä¼‘æ¯">ä¼‘æ¯</option>
                    `;
                    statusSelect.value = dayData.status || (i % 7 === 0 || i % 8 === 0 ? 'ä¼‘æ¯' : 'work');
                    statusCell.appendChild(statusSelect);
                    row.appendChild(statusCell);
                    
                    // çŸ­è§†é¢‘å‘å¸ƒæƒ…å†µ
                    const videoPublishCell = document.createElement('td');
                    const videoPublishContainer = document.createElement('div');
                    videoPublishContainer.className = 'input-with-select';
                    videoPublishContainer.innerHTML = `
                        <select class="video-publish-preset input-small">
                            <option value="0">æœªæŒ‰æ—¶å‘å¸ƒ</option>
                            <option value="15">æŒ‰æ—¶å‘å¸ƒ</option>
                            <option value="20">æå‰å‘å¸ƒ</option>
                        </select>
                        <input type="number" class="video-publish-input input-small" min="0" max="20" value="${dayData.videoPublish || '0'}">
                    `;
                    videoPublishCell.appendChild(videoPublishContainer);
                    row.appendChild(videoPublishCell);
                    
                    // çŸ­è§†é¢‘è´¨é‡
                    const videoQualityCell = document.createElement('td');
                    const videoQualityContainer = document.createElement('div');
                    videoQualityContainer.className = 'input-with-select';
                    videoQualityContainer.innerHTML = `
                        <select class="video-quality-preset input-small">
                            <option value="0">ä¸è¾¾æ ‡</option>
                            <option value="15">è¾¾æ ‡</option>
                            <option value="20">ä¼˜ç§€</option>
                        </select>
                        <input type="number" class="video-quality-input input-small" min="0" max="20" value="${dayData.videoQuality || '0'}">
                    `;
                    videoQualityCell.appendChild(videoQualityContainer);
                    row.appendChild(videoQualityCell);
                    
                    // æ‹æ‘„æŠ€å·§
                    const shootingCell = document.createElement('td');
                    const shootingInput = document.createElement('input');
                    shootingInput.type = 'number';
                    shootingInput.min = '0';
                    shootingInput.max = '15';
                    shootingInput.value = dayData.shooting || '0';
                    shootingInput.className = 'input-small shooting-input';
                    shootingCell.appendChild(shootingInput);
                    row.appendChild(shootingCell);
                    
                    // å‰ªè¾‘èƒ½åŠ›
                    const editingCell = document.createElement('td');
                    const editingInput = document.createElement('input');
                    editingInput.type = 'number';
                    editingInput.min = '0';
                    editingInput.max = '15';
                    editingInput.value = dayData.editing || '0';
                    editingInput.className = 'input-small editing-input';
                    editingCell.appendChild(editingInput);
                    row.appendChild(editingCell);
                    
                    // è€ƒå‹¤åˆè§„æ€§
                    const attendanceCell = document.createElement('td');
                    const attendanceInput = document.createElement('input');
                    attendanceInput.type = 'number';
                    attendanceInput.min = '0';
                    attendanceInput.max = '10';
                    attendanceInput.value = dayData.attendance || '0';
                    attendanceInput.className = 'input-small attendance-input';
                    attendanceCell.appendChild(attendanceInput);
                    row.appendChild(attendanceCell);
                    
                    // é…åˆåº¦
                    const cooperationCell = document.createElement('td');
                    const cooperationInput = document.createElement('input');
                    cooperationInput.type = 'number';
                    cooperationInput.min = '0';
                    cooperationInput.max = '20';
                    cooperationInput.value = dayData.cooperation || '0';
                    cooperationInput.className = 'input-medium cooperation-input';
                    cooperationCell.appendChild(cooperationInput);
                    row.appendChild(cooperationCell);
                    
                    // å½“æ—¥å¾—åˆ†
                    const scoreCell = document.createElement('td');
                    scoreCell.className = 'score-cell';
                    scoreCell.textContent = '0';
                    row.appendChild(scoreCell);
                    
                    // å½“æ—¥ç½šæ¬¾
                    const penaltyCell = document.createElement('td');
                    penaltyCell.className = 'penalty-cell';
                    penaltyCell.textContent = '0';
                    row.appendChild(penaltyCell);
                    
                    // é”å®šæŒ‰é’®
                    const lockCell = document.createElement('td');
                    const lockBtn = document.createElement('button');
                    lockBtn.className = `lock-btn ${dayData.locked ? 'locked' : ''}`;
                    lockBtn.innerHTML = dayData.locked ? '<i class="fas fa-lock"></i>' : '<i class="fas fa-lock-open"></i>';
                    lockBtn.addEventListener('click', () => this.toggleLock(employee.id, i-1, lockBtn, row));
                    lockCell.appendChild(lockBtn);
                    row.appendChild(lockCell);
                    
                    if (dayData.locked) {
                        row.classList.add('locked-row');
                    }
                    
                    dailyBody.appendChild(row);
                    
                    // ä¿å­˜æ•°æ®å¼•ç”¨
                    employeeMonthData[i-1] = {
                        row,
                        statusSelect,
                        videoPublishContainer,
                        videoQualityContainer,
                        shootingInput,
                        editingInput,
                        attendanceInput,
                        cooperationInput,
                        scoreCell,
                        penaltyCell,
                        lockBtn,
                        locked: dayData.locked || false
                    };
                    
                    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                    this.addEventListenersToVideoInputs(employeeMonthData[i-1]);
                }
                
                scrollableTable.appendChild(table);
                card.appendChild(scrollableTable);
                
                return card;
            },
            
            // ä¸ºç›´æ’­å²—è¾“å…¥é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            addEventListenersToLiveInputs(dataItem) {
                // ç›´æ’­æ—¶é•¿è¾“å…¥å˜åŒ–
                dataItem.liveDurationInput.addEventListener('input', function() {
                    this.updateLiveDayScore(dataItem);
                }.bind(this));
                
                // çŸ­è§†é¢‘é…åˆé¢„è®¾å€¼å˜åŒ–
                const videoPreset = dataItem.videoContainer.querySelector('.video-preset');
                const videoInput = dataItem.videoContainer.querySelector('.video-input');
                
                videoPreset.addEventListener('change', function() {
                    videoInput.value = this.value;
                    this.updateLiveDayScore(dataItem);
                }.bind(this));
                
                videoInput.addEventListener('input', function() {
                    // åŒæ­¥æ›´æ–°é¢„è®¾å€¼
                    const value = parseInt(this.value);
                    if (value === 0) videoPreset.value = '0';
                    else if (value === 25) videoPreset.value = '25';
                    else if (value === 30) videoPreset.value = '30';
                    
                    this.updateLiveDayScore(dataItem);
                }.bind(this));
                
                // å…¶ä»–è¾“å…¥é¡¹
                const inputs = [
                    dataItem.statusSelect,
                    dataItem.productInput,
                    dataItem.speechInput,
                    dataItem.droneInput,
                    dataItem.attendanceInput,
                    dataItem.cooperationInput
                ];
                
                inputs.forEach(input => {
                    input.addEventListener('change', function() {
                        this.updateLiveDayScore(dataItem);
                    }.bind(this));
                });
            },
            
            // ä¸ºçŸ­è§†é¢‘å²—è¾“å…¥é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            addEventListenersToVideoInputs(dataItem) {
                // çŸ­è§†é¢‘å‘å¸ƒé¢„è®¾å€¼å˜åŒ–
                const videoPublishPreset = dataItem.videoPublishContainer.querySelector('.video-publish-preset');
                const videoPublishInput = dataItem.videoPublishContainer.querySelector('.video-publish-input');
                
                videoPublishPreset.addEventListener('change', function() {
                    videoPublishInput.value = this.value;
                    this.updateVideoDayScore(dataItem);
                }.bind(this));
                
                videoPublishInput.addEventListener('input', function() {
                    // åŒæ­¥æ›´æ–°é¢„è®¾å€¼
                    const value = parseInt(this.value);
                    if (value === 0) videoPublishPreset.value = '0';
                    else if (value === 15) videoPublishPreset.value = '15';
                    else if (value === 20) videoPublishPreset.value = '20';
                    
                    this.updateVideoDayScore(dataItem);
                }.bind(this));
                
                // çŸ­è§†é¢‘è´¨é‡é¢„è®¾å€¼å˜åŒ–
                const videoQualityPreset = dataItem.videoQualityContainer.querySelector('.video-quality-preset');
                const videoQualityInput = dataItem.videoQualityContainer.querySelector('.video-quality-input');
                
                videoQualityPreset.addEventListener('change', function() {
                    videoQualityInput.value = this.value;
                    this.updateVideoDayScore(dataItem);
                }.bind(this));
                
                videoQualityInput.addEventListener('input', function() {
                    // åŒæ­¥æ›´æ–°é¢„è®¾å€¼
                    const value = parseInt(this.value);
                    if (value === 0) videoQualityPreset.value = '0';
                    else if (value === 15) videoQualityPreset.value = '15';
                    else if (value === 20) videoQualityPreset.value = '20';
                    
                    this.updateVideoDayScore(dataItem);
                }.bind(this));
                
                // å…¶ä»–è¾“å…¥é¡¹
                const inputs = [
                    dataItem.statusSelect,
                    dataItem.shootingInput,
                    dataItem.editingInput,
                    dataItem.attendanceInput,
                    dataItem.cooperationInput
                ];
                
                inputs.forEach(input => {
                    input.addEventListener('change', function() {
                        this.updateVideoDayScore(dataItem);
                    }.bind(this));
                });
            },
            
            // æ›´æ–°ç›´æ’­å²—å½“æ—¥å¾—åˆ†å’Œç½šæ¬¾
            updateLiveDayScore(dataItem) {
                const isWorkDay = dataItem.statusSelect.value === 'å·¥ä½œ';
                
                if (isWorkDay) {
                    // ç›´æ’­æ—¶é•¿å¾—åˆ†è®¡ç®—
                    const liveDuration = parseInt(dataItem.liveDurationInput.value) || 0;
                    let liveScore = 0;
                    
                    if (liveDuration >= 180) {
                        liveScore = 25;
                    } else if (liveDuration >= 120) {
                        liveScore = 15;
                    } else if (liveDuration >= 60) {
                        liveScore = 10;
                    } else {
                        liveScore = 0;
                    }
                    
                    dataItem.liveScoreCell.textContent = liveScore;
                    
                    // çŸ­è§†é¢‘å¾—åˆ†
                    const videoScore = parseInt(dataItem.videoContainer.querySelector('.video-input').value) || 0;
                    
                    // å­¦ä¹ èƒ½åŠ›
                    const productScore = parseInt(dataItem.productInput.value) || 0;
                    const speechScore = parseInt(dataItem.speechInput.value) || 0;
                    const droneScore = parseInt(dataItem.droneInput.value) || 0;
                    const learnScore = productScore + speechScore + droneScore;
                    
                    // å·¥ä½œæ€åº¦
                    const attendanceScore = parseInt(dataItem.attendanceInput.value) || 0;
                    const cooperationScore = parseInt(dataItem.cooperationInput.value) || 0;
                    const attitudeScore = attendanceScore + cooperationScore;
                    
                    // å½“æ—¥å¾—åˆ†
                    const dayScore = liveScore + videoScore + learnScore + attitudeScore;
                    dataItem.scoreCell.textContent = dayScore;
                    
                    // è®¡ç®—ç½šæ¬¾
                    let penalty = 0;
                    
                    // ç›´æ’­æ—¶é•¿ç½šæ¬¾
                    if (liveDuration < 180) {
                        penalty += (180 - liveDuration) * 10;
                    }
                    
                    // çŸ­è§†é¢‘æ‹æ‘„ç½šæ¬¾
                    if (videoScore === 0) {
                        penalty += 50;
                    }
                    
                    dataItem.penaltyCell.textContent = penalty;
                    
                    // è®¾ç½®é¢œè‰²
                    if (dayScore >= 80) {
                        dataItem.scoreCell.className = 'score-cell high-score';
                    } else if (dayScore >= 70) {
                        dataItem.scoreCell.className = 'score-cell medium-score';
                    } else {
                        dataItem.scoreCell.className = 'score-cell low-score';
                    }
                } else {
                    // ä¼‘æ¯æ—¥
                    dataItem.scoreCell.textContent = 'ä¼‘æ¯';
                    dataItem.scoreCell.className = 'score-cell';
                    dataItem.penaltyCell.textContent = '0';
                }
            },
            
            // æ›´æ–°çŸ­è§†é¢‘å²—å½“æ—¥å¾—åˆ†å’Œç½šæ¬¾
            updateVideoDayScore(dataItem) {
                const isWorkDay = dataItem.statusSelect.value === 'å·¥ä½œ';
                
                if (isWorkDay) {
                    // çŸ­è§†é¢‘å‘å¸ƒå¾—åˆ†
                    const videoPublishScore = parseInt(dataItem.videoPublishContainer.querySelector('.video-publish-input').value) || 0;
                    
                    // çŸ­è§†é¢‘è´¨é‡å¾—åˆ†
                    const videoQualityScore = parseInt(dataItem.videoQualityContainer.querySelector('.video-quality-input').value) || 0;
                    
                    // æ‹æ‘„æŠ€å·§
                    const shootingScore = parseInt(dataItem.shootingInput.value) || 0;
                    
                    // å‰ªè¾‘èƒ½åŠ›
                    const editingScore = parseInt(dataItem.editingInput.value) || 0;
                    
                    // å·¥ä½œæ€åº¦
                    const attendanceScore = parseInt(dataItem.attendanceInput.value) || 0;
                    const cooperationScore = parseInt(dataItem.cooperationInput.value) || 0;
                    const attitudeScore = attendanceScore + cooperationScore;
                    
                    // å½“æ—¥å¾—åˆ†
                    const dayScore = videoPublishScore + videoQualityScore + shootingScore + editingScore + attitudeScore;
                    dataItem.scoreCell.textContent = dayScore;
                    
                    // è®¡ç®—ç½šæ¬¾
                    let penalty = 0;
                    
                    // æœªæŒ‰æ—¶å‘å¸ƒè§†é¢‘ç½šæ¬¾
                    if (videoPublishScore === 0) {
                        penalty += 50;
                    }
                    
                    // è§†é¢‘è´¨é‡ä¸è¾¾æ ‡ç½šæ¬¾
                    if (videoQualityScore === 0) {
                        penalty += 30;
                    }
                    
                    dataItem.penaltyCell.textContent = penalty;
                    
                    // è®¾ç½®é¢œè‰²
                    if (dayScore >= 80) {
                        dataItem.scoreCell.className = 'score-cell high-score';
                    } else if (dayScore >= 70) {
                        dataItem.scoreCell.className = 'score-cell medium-score';
                    } else {
                        dataItem.scoreCell.className = 'score-cell low-score';
                    }
                } else {
                    // ä¼‘æ¯æ—¥
                    dataItem.scoreCell.textContent = 'ä¼‘æ¯';
                    dataItem.scoreCell.className = 'score-cell';
                    dataItem.penaltyCell.textContent = '0';
                }
            },
            
            // é”å®š/è§£é”å•æ¡è®°å½•
            toggleLock(employeeId, dayIndex, lockBtn, row) {
                // è·å–å½“å‰é€‰æ‹©çš„æœˆä»½å’Œå¹´ä»½
                const month = document.getElementById('monthSelect').value;
                const year = document.getElementById('yearSelect').value;
                
                const employeeMonthData = AppState.dailyData[employeeId][`${year}-${month}`];
                const dayData = employeeMonthData[dayIndex];
                
                if (dayData.locked) {
                    // è§£é”è®°å½•
                    document.getElementById('passwordModal').style.display = 'flex';
                    
                    document.getElementById('confirmUnlock').onclick = function() {
                        const password = document.getElementById('passwordInput').value;
                        if (password === AppState.LOCK_PASSWORD) {
                            dayData.locked = false;
                            lockBtn.classList.remove('locked');
                            lockBtn.innerHTML = '<i class="fas fa-lock-open"></i>';
                            row.classList.remove('locked-row');
                            document.getElementById('passwordModal').style.display = 'none';
                            document.getElementById('passwordInput').value = '';
                            DataManager.saveData();
                        } else {
                            Utils.showNotification('å¯†ç é”™è¯¯ï¼', 'error');
                        }
                    };
                } else {
                    // é”å®šè®°å½•
                    dayData.locked = true;
                    lockBtn.classList.add('locked');
                    lockBtn.innerHTML = '<i class="fas fa-lock"></i>';
                    row.classList.add('locked-row');
                    DataManager.saveData();
                }
            },
            
            // æ›´æ–°æ±‡æ€»è¡¨æ ¼
            updateSummaryTable() {
                const summaryBody = document.getElementById('summaryBody');
                summaryBody.innerHTML = '';
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                document.getElementById('totalEmployees').textContent = AppState.employees.length;
                
                let totalScore = 0;
                let qualifiedCount = 0;
                let excellentCount = 0;
                let totalPenalty = 0;
                
                AppState.employees.forEach(employee => {
                    totalScore += parseFloat(employee.totalScore || 0);
                    totalPenalty += parseFloat(employee.penaltyTotal || 0);
                    
                    if (parseFloat(employee.totalScore || 0) >= CONSTANTS.SCORE_THRESHOLDS.GOOD) {
                        qualifiedCount++;
                    }
                    if (parseFloat(employee.totalScore || 0) >= CONSTANTS.SCORE_THRESHOLDS.EXCELLENT) {
                        excellentCount++;
                    }
                    
                    const row = document.createElement('tr');
                    
                    if (employee.position === 'live') {
                        row.innerHTML = `
                            <td>${employee.name}</td>
                            <td>ç›´æ’­å²—</td>
                            <td class="score-cell">${employee.liveAvg || '0.00'}</td>
                            <td class="score-cell">${employee.videoAvg || '0.00'}</td>
                            <td class="score-cell">${employee.productAvg || '0.00'}</td>
                            <td class="score-cell">${employee.speechAvg || '0.00'}</td>
                            <td class="score-cell">${employee.droneAvg || '0.00'}</td>
                            <td class="score-cell">${employee.attendanceAvg || '0.00'}</td>
                            <td class="score-cell">${employee.cooperationAvg || '0.00'}</td>
                            <td class="score-cell ${parseFloat(employee.totalScore) >= CONSTANTS.SCORE_THRESHOLDS.GOOD ? 'high-score' : parseFloat(employee.totalScore) >= CONSTANTS.SCORE_THRESHOLDS.PASS ? 'medium-score' : 'low-score'}">${employee.totalScore || '0.00'}</td>
                            <td class="penalty-cell">${employee.penaltyTotal || '0'}</td>
                            <td>${employee.grade || '-'}</td>
                        `;
                    } else {
                        row.innerHTML = `
                            <td>${employee.name}</td>
                            <td>çŸ­è§†é¢‘å²—</td>
                            <td class="score-cell">-</td>
                            <td class="score-cell">${employee.videoPublishAvg || '0.00'}/${employee.videoQualityAvg || '0.00'}</td>
                            <td class="score-cell">-</td>
                            <td class="score-cell">-</td>
                            <td class="score-cell">-</td>
                            <td class="score-cell">${employee.attendanceAvg || '0.00'}</td>
                            <td class="score-cell">${employee.cooperationAvg || '0.00'}</td>
                            <td class="score-cell ${parseFloat(employee.totalScore) >= CONSTANTS.SCORE_THRESHOLDS.GOOD ? 'high-score' : parseFloat(employee.totalScore) >= CONSTANTS.SCORE_THRESHOLDS.PASS ? 'medium-score' : 'low-score'}">${employee.totalScore || '0.00'}</td>
                            <td class="penalty-cell">${employee.penaltyTotal || '0'}</td>
                            <td>${employee.grade || '-'}</td>
                        `;
                    }
                    
                    summaryBody.appendChild(row);
                });
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                document.getElementById('avgScore').textContent = AppState.employees.length > 0 ? (totalScore / AppState.employees.length).toFixed(2) : '0.00';
                document.getElementById('qualifiedRate').textContent = AppState.employees.length > 0 ? Math.round(qualifiedCount / AppState.employees.length * 100) + '%' : '0%';
                document.getElementById('excellentRate').textContent = AppState.employees.length > 0 ? Math.round(excellentCount / AppState.employees.length * 100) + '%' : '0%';
                document.getElementById('totalPenalty').textContent = totalPenalty;
                
                // ä¿å­˜å½“å‰æœˆä»½æ•°æ®ç”¨äºè¿›æ­¥ä¹‹æ˜Ÿè®¡ç®—
                Calculation.saveCurrentMonthData();
            },
            
            // åˆå§‹åŒ–ç®¡ç†å‘˜åŠŸèƒ½
            initAdminFunctions() {
                const adminEmployeeList = document.getElementById('adminEmployeeList');
                adminEmployeeList.innerHTML = '';
                
                AppState.employees.forEach(employee => {
                    const employeeItem = document.createElement('div');
                    employeeItem.className = 'employee-item';
                    employeeItem.innerHTML = `
                        <div class="employee-info">
                            <span class="employee-name">${employee.name}</span>
                            <span class="employee-position">${employee.position === 'live' ? 'ç›´æ’­å²—' : 'çŸ­è§†é¢‘å²—'}</span>
                        </div>
                        <button class="btn btn-danger delete-employee" data-id="${employee.id}">
                            <i class="fas fa-trash"></i> åˆ é™¤
                        </button>
                    `;
                    adminEmployeeList.appendChild(employeeItem);
                });
                
                // æ·»åŠ åˆ é™¤å‘˜å·¥äº‹ä»¶
                document.querySelectorAll('.delete-employee').forEach(button => {
                    button.addEventListener('click', function() {
                        const employeeId = parseInt(this.getAttribute('data-id'));
                        AdminManager.deleteEmployee(employeeId);
                    });
                });
                
                // åˆå§‹åŒ–å›¾æ ‡é€‰æ‹©å™¨
                IconManager.initIconSelector();
            }
        };

        // è®¡ç®—æ¨¡å—
        const Calculation = {
            // è®¡ç®—æ‰€æœ‰å‘˜å·¥å¾—åˆ†
            calculateAllScores() {
                AppState.employees.forEach(employee => {
                    if (employee.position === 'live') {
                        this.calculateLiveEmployeeScores(employee.id);
                    } else {
                        this.calculateVideoEmployeeScores(employee.id);
                    }
                });
                
                UI.updateSummaryTable();
                DataManager.saveData();
                Utils.showNotification('è€ƒæ ¸ç»“æœè®¡ç®—å®Œæˆï¼', 'success');
            },
            
            // è®¡ç®—ç›´æ’­å²—å‘˜å·¥å¾—åˆ†
            calculateLiveEmployeeScores(employeeId) {
                const employee = AppState.employees.find(emp => emp.id === employeeId);
                if (!employee || employee.position !== 'live') return;
                
                // è·å–å½“å‰é€‰æ‹©çš„æœˆä»½å’Œå¹´ä»½
                const month = document.getElementById('monthSelect').value;
                const year = document.getElementById('yearSelect').value;
                
                const employeeMonthData = AppState.dailyData[employeeId]?.[`${year}-${month}`];
                if (!employeeMonthData) return;
                
                let workDays = 0;
                let liveTotal = 0;
                let videoTotal = 0;
                let learnProductTotal = 0;
                let learnSpeechTotal = 0;
                let learnDroneTotal = 0;
                let attitudeAttendanceTotal = 0;
                let attitudeCooperationTotal = 0;
                let penaltyTotal = 0;
                
                employeeMonthData.forEach(dayData => {
                    if (dayData.statusSelect && dayData.statusSelect.value === 'å·¥ä½œ') {
                        workDays++;
                        
                        // ç›´æ’­å¾—åˆ†
                        const liveDuration = parseInt(dayData.liveDurationInput.value) || 0;
                        let liveScore = 0;
                        
                        if (liveDuration >= 180) {
                            liveScore = 25;
                        } else if (liveDuration >= 120) {
                            liveScore = 15;
                        } else if (liveDuration >= 60) {
                            liveScore = 10;
                        }
                        
                        liveTotal += liveScore;
                        
                        // çŸ­è§†é¢‘å¾—åˆ†
                        const videoScore = parseInt(dayData.videoContainer.querySelector('.video-input').value) || 0;
                        videoTotal += videoScore;
                        
                        // å­¦ä¹ èƒ½åŠ›
                        const productScore = parseInt(dayData.productInput.value) || 0;
                        const speechScore = parseInt(dayData.speechInput.value) || 0;
                        const droneScore = parseInt(dayData.droneInput.value) || 0;
                        
                        learnProductTotal += productScore;
                        learnSpeechTotal += speechScore;
                        learnDroneTotal += droneScore;
                        
                        // å·¥ä½œæ€åº¦
                        const attendanceScore = parseInt(dayData.attendanceInput.value) || 0;
                        const cooperationScore = parseInt(dayData.cooperationInput.value) || 0;
                        
                        attitudeAttendanceTotal += attendanceScore;
                        attitudeCooperationTotal += cooperationScore;
                        
                        // ç½šæ¬¾
                        const penalty = parseInt(dayData.penaltyCell.textContent) || 0;
                        penaltyTotal += penalty;
                    }
                });
                
                // æ›´æ–°å‘˜å·¥æ•°æ®
                employee.liveAvg = workDays > 0 ? (liveTotal / workDays).toFixed(2) : '0.00';
                employee.videoAvg = workDays > 0 ? (videoTotal / workDays).toFixed(2) : '0.00';
                employee.productAvg = workDays > 0 ? (learnProductTotal / workDays).toFixed(2) : '0.00';
                employee.speechAvg = workDays > 0 ? (learnSpeechTotal / workDays).toFixed(2) : '0.00';
                employee.droneAvg = workDays > 0 ? (learnDroneTotal / workDays).toFixed(2) : '0.00';
                employee.attendanceAvg = workDays > 0 ? (attitudeAttendanceTotal / workDays).toFixed(2) : '0.00';
                employee.cooperationAvg = workDays > 0 ? (attitudeCooperationTotal / workDays).toFixed(2) : '0.00';
                employee.penaltyTotal = penaltyTotal;
                
                // è®¡ç®—æ€»åˆ†
                employee.totalScore = (parseFloat(employee.liveAvg) + parseFloat(employee.videoAvg) + 
                                      parseFloat(employee.productAvg) + parseFloat(employee.speechAvg) + parseFloat(employee.droneAvg) +
                                      parseFloat(employee.attendanceAvg) + parseFloat(employee.cooperationAvg)).toFixed(2);
                
                // åˆ¤æ–­è€ƒæ ¸ç­‰çº§
                if (employee.totalScore >= 90) {
                    employee.grade = "ä¼˜ç§€";
                } else if (employee.totalScore >= 80) {
                    employee.grade = "è‰¯å¥½";
                } else if (employee.totalScore >= 70) {
                    employee.grade = "åˆæ ¼";
                } else {
                    employee.grade = "ä¸åˆæ ¼";
                }
            },
            
            // è®¡ç®—çŸ­è§†é¢‘å²—å‘˜å·¥å¾—åˆ†
            calculateVideoEmployeeScores(employeeId) {
                const employee = AppState.employees.find(emp => emp.id === employeeId);
                if (!employee || employee.position !== 'video') return;
                
                // è·å–å½“å‰é€‰æ‹©çš„æœˆä»½å’Œå¹´ä»½
                const month = document.getElementById('monthSelect').value;
                const year = document.getElementById('yearSelect').value;
                
                const employeeMonthData = AppState.dailyData[employeeId]?.[`${year}-${month}`];
                if (!employeeMonthData) return;
                
                let workDays = 0;
                let videoPublishTotal = 0;
                let videoQualityTotal = 0;
                let shootingTotal = 0;
                let editingTotal = 0;
                let attitudeAttendanceTotal = 0;
                let attitudeCooperationTotal = 0;
                let penaltyTotal = 0;
                
                employeeMonthData.forEach(dayData => {
                    if (dayData.statusSelect && dayData.statusSelect.value === 'å·¥ä½œ') {
                        workDays++;
                        
                        // çŸ­è§†é¢‘å‘å¸ƒå¾—åˆ†
                        const videoPublishScore = parseInt(dayData.videoPublishContainer.querySelector('.video-publish-input').value) || 0;
                        videoPublishTotal += videoPublishScore;
                        
                        // çŸ­è§†é¢‘è´¨é‡å¾—åˆ†
                        const videoQualityScore = parseInt(dayData.videoQualityContainer.querySelector('.video-quality-input').value) || 0;
                        videoQualityTotal += videoQualityScore;
                        
                        // æ‹æ‘„æŠ€å·§
                        const shootingScore = parseInt(dayData.shootingInput.value) || 0;
                        shootingTotal += shootingScore;
                        
                        // å‰ªè¾‘èƒ½åŠ›
                        const editingScore = parseInt(dayData.editingInput.value) || 0;
                        editingTotal += editingScore;
                        
                        // å·¥ä½œæ€åº¦
                        const attendanceScore = parseInt(dayData.attendanceInput.value) || 0;
                        const cooperationScore = parseInt(dayData.cooperationInput.value) || 0;
                        
                        attitudeAttendanceTotal += attendanceScore;
                        attitudeCooperationTotal += cooperationScore;
                        
                        // ç½šæ¬¾
                        const penalty = parseInt(dayData.penaltyCell.textContent) || 0;
                        penaltyTotal += penalty;
                    }
                });
                
                // æ›´æ–°å‘˜å·¥æ•°æ®
                employee.videoPublishAvg = workDays > 0 ? (videoPublishTotal / workDays).toFixed(2) : '0.00';
                employee.videoQualityAvg = workDays > 0 ? (videoQualityTotal / workDays).toFixed(2) : '0.00';
                employee.shootingAvg = workDays > 0 ? (shootingTotal / workDays).toFixed(2) : '0.00';
                employee.editingAvg = workDays > 0 ? (editingTotal / workDays).toFixed(2) : '0.00';
                employee.attendanceAvg = workDays > 0 ? (attitudeAttendanceTotal / workDays).toFixed(2) : '0.00';
                employee.cooperationAvg = workDays > 0 ? (attitudeCooperationTotal / workDays).toFixed(2) : '0.00';
                employee.penaltyTotal = penaltyTotal;
                
                // è®¡ç®—æ€»åˆ†
                employee.totalScore = (parseFloat(employee.videoPublishAvg) + parseFloat(employee.videoQualityAvg) + 
                                      parseFloat(employee.shootingAvg) + parseFloat(employee.editingAvg) +
                                      parseFloat(employee.attendanceAvg) + parseFloat(employee.cooperationAvg)).toFixed(2);
                
                // åˆ¤æ–­è€ƒæ ¸ç­‰çº§
                if (employee.totalScore >= 90) {
                    employee.grade = "ä¼˜ç§€";
                } else if (employee.totalScore >= 80) {
                    employee.grade = "è‰¯å¥½";
                } else if (employee.totalScore >= 70) {
                    employee.grade = "åˆæ ¼";
                } else {
                    employee.grade = "ä¸åˆæ ¼";
                }
            },
            
            // ä¿å­˜å½“å‰æœˆä»½æ•°æ®ç”¨äºè¿›æ­¥ä¹‹æ˜Ÿè®¡ç®—
            saveCurrentMonthData() {
                const month = document.getElementById('monthSelect').value;
                const year = document.getElementById('yearSelect').value;
                const monthKey = `${year}-${month}`;
                
                AppState.employees.forEach(employee => {
                    if (!AppState.previousMonthData[employee.id]) {
                        AppState.previousMonthData[employee.id] = {};
                    }
                    
                    AppState.previousMonthData[employee.id][monthKey] = {
                        totalScore: employee.totalScore,
                        penaltyTotal: employee.penaltyTotal
                    };
                });
                
                DataManager.saveData();
            },
            
            // è®¡ç®—æœˆåº¦è¯„ä¼˜ç»“æœ
            calculateMonthlyAwards() {
                // è·å–å½“å‰æœˆä»½å’Œå¹´ä»½
                const month = document.getElementById('monthSelect').value;
                const year = document.getElementById('yearSelect').value;
                
                // æœˆåº¦ä¸šç»©ä¹‹æ˜Ÿ
                const liveEmployees = AppState.employees.filter(emp => 
                    emp.position === 'live' && 
                    parseFloat(emp.totalScore) >= 90 && 
                    emp.penaltyTotal === 0
                );
                
                const videoEmployees = AppState.employees.filter(emp => 
                    emp.position === 'video' && 
                    parseFloat(emp.totalScore) >= 90 && 
                    emp.penaltyTotal === 0
                );
                
                // æŒ‰å¾—åˆ†ä»é«˜åˆ°ä½æ’åº
                liveEmployees.sort((a, b) => parseFloat(b.totalScore) - parseFloat(a.totalScore));
                videoEmployees.sort((a, b) => parseFloat(b.totalScore) - parseFloat(a.totalScore));
                
                // å–ç¬¬ä¸€å
                const performanceStarLive = liveEmployees.length > 0 ? liveEmployees[0] : null;
                const performanceStarVideo = videoEmployees.length > 0 ? videoEmployees[0] : null;
                
                // æœˆåº¦è¿›æ­¥ä¹‹æ˜Ÿ
                let progressStar = null;
                let maxProgress = 0;
                
                AppState.employees.forEach(employee => {
                    // è·å–ä¸Šæœˆæ•°æ®
                    const prevMonthKey = Utils.getPreviousMonthKey(year, month);
                    const prevMonthData = AppState.previousMonthData[employee.id]?.[prevMonthKey];
                    
                    if (prevMonthData && prevMonthData.totalScore) {
                        const currentScore = parseFloat(employee.totalScore);
                        const previousScore = parseFloat(prevMonthData.totalScore);
                        const progress = currentScore - previousScore;
                        
                        if (progress >= 10 && currentScore >= 80 && employee.penaltyTotal === 0) {
                            if (progress > maxProgress) {
                                maxProgress = progress;
                                progressStar = employee;
                            }
                        }
                    }
                });
                
                // æ›´æ–°æ˜¾ç¤º
                const performanceStarWinner = document.getElementById('performanceStarWinner');
                const progressStarWinner = document.getElementById('progressStarWinner');
                
                let performanceText = '';
                if (performanceStarLive && performanceStarVideo) {
                    performanceText = `ç›´æ’­å²—: ${performanceStarLive.name}, çŸ­è§†é¢‘å²—: ${performanceStarVideo.name}`;
                } else if (performanceStarLive) {
                    performanceText = `ç›´æ’­å²—: ${performanceStarLive.name}`;
                } else if (performanceStarVideo) {
                    performanceText = `çŸ­è§†é¢‘å²—: ${performanceStarVideo.name}`;
                } else {
                    performanceText = 'æœ¬æœˆæš‚æ— ç¬¦åˆæ¡ä»¶çš„äººé€‰';
                }
                
                performanceStarWinner.textContent = `æœ¬æœˆè·å¥–è€…: ${performanceText}`;
                progressStarWinner.textContent = progressStar ? 
                    `æœ¬æœˆè·å¥–è€…: ${progressStar.name} (è¿›æ­¥${maxProgress}åˆ†)` : 
                    'æœ¬æœˆæš‚æ— ç¬¦åˆæ¡ä»¶çš„äººé€‰';
                
                // æ›´æ–°æƒ©ç½šè®°å½•æ˜¾ç¤º
                this.updatePenaltyList();
                
                Utils.showNotification('è¯„ä¼˜ç»“æœè®¡ç®—å®Œæˆï¼', 'success');
            },
            
            // æ›´æ–°æƒ©ç½šè®°å½•æ˜¾ç¤º
            updatePenaltyList() {
                const penaltyList = document.getElementById('penaltyList');
                penaltyList.innerHTML = '';
                
                let hasPenalties = false;
                
                AppState.employees.forEach(employee => {
                    if (employee.penaltyTotal > 0) {
                        hasPenalties = true;
                        const penaltyItem = document.createElement('div');
                        penaltyItem.className = 'penalty-item';
                        penaltyItem.innerHTML = `
                            <div>
                                <strong>${employee.name}</strong> (${employee.position === 'live' ? 'ç›´æ’­å²—' : 'çŸ­è§†é¢‘å²—'})
                            </div>
                            <div class="penalty-amount">ç½šæ¬¾: ${employee.penaltyTotal}å…ƒ</div>
                        `;
                        penaltyList.appendChild(penaltyItem);
                    }
                });
                
                if (!hasPenalties) {
                    penaltyList.innerHTML = '<p style="text-align: center; padding: 20px; color: var(--gray);">æœ¬æœˆæ— æƒ©ç½šè®°å½•</p>';
                }
            }
        };

        // å›¾æ ‡ç®¡ç†æ¨¡å—
        const IconManager = {
            // åˆå§‹åŒ–å›¾æ ‡é€‰æ‹©å™¨
            initIconSelector() {
                const iconGrid = document.getElementById('iconGrid');
                iconGrid.innerHTML = '';
                
                CONSTANTS.ICONS.forEach(iconData => {
                    const iconOption = document.createElement('div');
                    iconOption.className = `icon-option ${iconData.icon === AppState.selectedIcon ? 'active' : ''}`;
                    iconOption.innerHTML = `
                        <div class="icon-preview">${iconData.icon}</div>
                        <div>${iconData.name}</div>
                    `;
                    iconOption.addEventListener('click', () => {
                        // ç§»é™¤æ‰€æœ‰activeç±»
                        document.querySelectorAll('.icon-option').forEach(option => {
                            option.classList.remove('active');
                        });
                        
                        // æ·»åŠ activeç±»
                        iconOption.classList.add('active');
                        
                        // æ›´æ–°é€‰ä¸­çš„å›¾æ ‡
                        AppState.selectedIcon = iconData.icon;
                    });
                    iconGrid.appendChild(iconOption);
                });
            },
            
            // åº”ç”¨å›¾æ ‡
            applyIcon() {
                Utils.changeFavicon(AppState.selectedIcon);
                DataManager.saveData();
                Utils.showNotification('å›¾æ ‡å·²æ›´æ–°ï¼', 'success');
            }
        };

        // ç®¡ç†å‘˜åŠŸèƒ½æ¨¡å—
        const AdminManager = {
            // æ·»åŠ å‘˜å·¥
            addEmployee() {
                if (!AppState.isAdminAuthenticated) {
                    Utils.showNotification('è¯·å…ˆéªŒè¯ç®¡ç†å‘˜èº«ä»½ï¼', 'error');
                    return;
                }
                
                const nameInput = document.getElementById('employeeName');
                const positionSelect = document.getElementById('employeePosition');
                const name = nameInput.value.trim();
                const position = positionSelect.value;
                
                if (!name) {
                    Utils.showNotification('è¯·è¾“å…¥å‘˜å·¥å§“åï¼', 'error');
                    return;
                }
                
                // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨åŒåå‘˜å·¥
                if (AppState.employees.some(emp => emp.name === name)) {
                    Utils.showNotification('å·²å­˜åœ¨åŒåå‘˜å·¥ï¼', 'error');
                    return;
                }
                
                const newId = AppState.employees.length > 0 ? Math.max(...AppState.employees.map(e => e.id)) + 1 : 1;
                AppState.employees.push({
                    id: newId,
                    name: name,
                    position: position,
                    selected: true
                });
                
                nameInput.value = '';
                UI.initEmployeeSelector();
                UI.initAdminFunctions();
                UI.updateSummaryTable();
                DataManager.saveData();
                Utils.showNotification('å‘˜å·¥æ·»åŠ æˆåŠŸï¼', 'success');
            },
            
            // åˆ é™¤å‘˜å·¥
            deleteEmployee(employeeId) {
                if (!AppState.isAdminAuthenticated) {
                    Utils.showNotification('è¯·å…ˆéªŒè¯ç®¡ç†å‘˜èº«ä»½ï¼', 'error');
                    return;
                }
                
                if (confirm('ç¡®å®šè¦åˆ é™¤æ­¤å‘˜å·¥å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼')) {
                    AppState.employees = AppState.employees.filter(emp => emp.id !== employeeId);
                    delete AppState.dailyData[employeeId];
                    
                    UI.initEmployeeSelector();
                    UI.initAdminFunctions();
                    UI.updateSummaryTable();
                    DataManager.saveData();
                    Utils.showNotification('å‘˜å·¥åˆ é™¤æˆåŠŸï¼', 'success');
                }
            },
            
            // ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
            changeAdminPassword() {
                if (!AppState.isAdminAuthenticated) {
                    Utils.showNotification('è¯·å…ˆéªŒè¯ç®¡ç†å‘˜èº«ä»½ï¼', 'error');
                    return;
                }
                
                const currentPassword = document.getElementById('currentAdminPassword').value;
                const newPassword = document.getElementById('newAdminPassword').value;
                const confirmPassword = document.getElementById('confirmAdminPassword').value;
                
                if (currentPassword !== AppState.ADMIN_PASSWORD) {
                    Utils.showNotification('å½“å‰å¯†ç é”™è¯¯ï¼', 'error');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    Utils.showNotification('æ–°å¯†ç ä¸ç¡®è®¤å¯†ç ä¸ä¸€è‡´ï¼', 'error');
                    return;
                }
                
                if (newPassword.length < 4) {
                    Utils.showNotification('å¯†ç é•¿åº¦è‡³å°‘4ä½ï¼', 'error');
                    return;
                }
                
                AppState.ADMIN_PASSWORD = newPassword;
                document.getElementById('currentAdminPassword').value = '';
                document.getElementById('newAdminPassword').value = '';
                document.getElementById('confirmAdminPassword').value = '';
                DataManager.saveData();
                Utils.showNotification('ç®¡ç†å‘˜å¯†ç ä¿®æ”¹æˆåŠŸï¼', 'success');
            },
            
            // ä¿®æ”¹é”å®šå¯†ç 
            changeLockPassword() {
                if (!AppState.isAdminAuthenticated) {
                    Utils.showNotification('è¯·å…ˆéªŒè¯ç®¡ç†å‘˜èº«ä»½ï¼', 'error');
                    return;
                }
                
                const currentPassword = document.getElementById('currentLockPassword').value;
                const newPassword = document.getElementById('newLockPassword').value;
                const confirmPassword = document.getElementById('confirmLockPassword').value;
                
                if (currentPassword !== AppState.LOCK_PASSWORD) {
                    Utils.showNotification('å½“å‰å¯†ç é”™è¯¯ï¼', 'error');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    Utils.showNotification('æ–°å¯†ç ä¸ç¡®è®¤å¯†ç ä¸ä¸€è‡´ï¼', 'error');
                    return;
                }
                
                if (newPassword.length < 4) {
                    Utils.showNotification('å¯†ç é•¿åº¦è‡³å°‘4ä½ï¼', 'error');
                    return;
                }
                
                AppState.LOCK_PASSWORD = newPassword;
                document.getElementById('currentLockPassword').value = '';
                document.getElementById('newLockPassword').value = '';
                document.getElementById('confirmLockPassword').value = '';
                DataManager.saveData();
                Utils.showNotification('é”å®šå¯†ç ä¿®æ”¹æˆåŠŸï¼', 'success');
            }
        };

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', function() {
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®
            DataManager.loadData();
            
            // åˆå§‹åŒ–UIç»„ä»¶
            UI.initYearSelector();
            UI.initEmployeeSelector();
            UI.initEmployeeDailyData(AppState.currentEmployeeId);
            UI.updateSummaryTable();
            
            // æ ‡ç­¾é¡µåˆ‡æ¢
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // ç§»é™¤æ‰€æœ‰activeç±»
                    document.querySelectorAll('.tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    document.querySelectorAll('.tab-content').forEach(c => {
                        c.classList.remove('active');
                    });
                    
                    // æ·»åŠ activeç±»
                    tab.classList.add('active');
                    document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
                });
            });
            
            // æœˆä»½é€‰æ‹©å˜åŒ–äº‹ä»¶
            document.getElementById('monthSelect').addEventListener('change', function() {
                UI.initEmployeeDailyData(AppState.currentEmployeeId);
            });
            
            // å¹´ä»½é€‰æ‹©å˜åŒ–äº‹ä»¶
            document.getElementById('yearSelect').addEventListener('change', function() {
                UI.initEmployeeDailyData(AppState.currentEmployeeId);
            });
            
            // è®¡ç®—è€ƒæ ¸ç»“æœæŒ‰é’®
            document.getElementById('calculateBtn').addEventListener('click', Calculation.calculateAllScores);
            
            // è®¡ç®—è¯„ä¼˜ç»“æœæŒ‰é’®
            document.getElementById('calculateAwardsBtn').addEventListener('click', Calculation.calculateMonthlyAwards);
            
            // ä¿å­˜æ•°æ®æŒ‰é’®
            document.getElementById('saveDataBtn').addEventListener('click', DataManager.saveData);
            
            // å¯¼å‡ºæ•°æ®æŒ‰é’®
            document.getElementById('exportDataBtn').addEventListener('click', DataManager.exportData);
            
            // å¯¼å…¥æ•°æ®æŒ‰é’®
            document.getElementById('importDataBtn').addEventListener('click', function() {
                const fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = '.json';
                fileInput.addEventListener('change', function() {
                    if (this.files.length > 0) {
                        DataManager.importData(this.files[0]);
                    }
                });
                fileInput.click();
            });
            
            // é‡ç½®æ•°æ®æŒ‰é’®
            document.getElementById('resetDataBtn').addEventListener('click', DataManager.resetData);
            
            // éªŒè¯ç®¡ç†å‘˜èº«ä»½
            document.getElementById('verifyAdminBtn').addEventListener('click', function() {
                const password = document.getElementById('adminPassword').value;
                if (password === AppState.ADMIN_PASSWORD) {
                    document.getElementById('adminFunctions').style.display = 'block';
                    document.getElementById('adminLoginCard').style.display = 'none';
                    AppState.isAdminAuthenticated = true;
                    UI.initAdminFunctions();
                    Utils.showNotification('èº«ä»½éªŒè¯æˆåŠŸï¼', 'success');
                } else {
                    Utils.showNotification('å¯†ç é”™è¯¯ï¼', 'error');
                }
            });
            
            // é€€å‡ºç®¡ç†å‘˜
            document.getElementById('logoutAdminBtn').addEventListener('click', function() {
                document.getElementById('adminFunctions').style.display = 'none';
                document.getElementById('adminLoginCard').style.display = 'block';
                AppState.isAdminAuthenticated = false;
                document.getElementById('adminPassword').value = '';
                Utils.showNotification('å·²é€€å‡ºç®¡ç†å‘˜æ¨¡å¼ï¼', 'success');
            });
            
            // æ·»åŠ å‘˜å·¥
            document.getElementById('addEmployee').addEventListener('click', AdminManager.addEmployee);
            
            // ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
            document.getElementById('changeAdminPasswordBtn').addEventListener('click', AdminManager.changeAdminPassword);
            
            // ä¿®æ”¹é”å®šå¯†ç 
            document.getElementById('changeLockPasswordBtn').addEventListener('click', AdminManager.changeLockPassword);
            
            // åº”ç”¨å›¾æ ‡æŒ‰é’®
            document.getElementById('applyIconBtn').addEventListener('click', IconManager.applyIcon);
            
            // å–æ¶ˆè§£é”
            document.getElementById('cancelUnlock').addEventListener('click', function() {
                document.getElementById('passwordModal').style.display = 'none';
                document.getElementById('passwordInput').value = '';
            });
            
            // å…³é—­é€šçŸ¥
            document.getElementById('notification-close').addEventListener('click', Utils.hideNotification);
        });
    </script>
</body>
</html>